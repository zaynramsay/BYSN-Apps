---
import { APPS } from '@/lib/constants';

interface Props {
  links?: Array<{ label: string; href: string }>;
}

const { links = [
  { label: 'Features', href: '#features' },
  { label: 'How It Works', href: '#how-it-works' },
  { label: 'Privacy', href: '#privacy' },
] } = Astro.props;
---

<nav class="cake-nav fixed top-0 left-0 right-0 z-50 transition-all duration-300">
  <div class="max-w-[1200px] mx-auto px-6 py-4 flex items-center justify-between">
    <!-- Logo -->
    <a href="/apps/cake" class="flex items-center gap-3 group">
      <img
        src="/assets/cakeLogo.png"
        alt="Cake"
        class="w-9 h-9 rounded-xl transition-transform duration-300 group-hover:scale-110"
      />
      <span class="text-white font-bold text-lg tracking-tight">Cake</span>
    </a>

    <!-- Nav Links (desktop) -->
    <div class="hidden md:flex items-center gap-8">
      {links.map((link) => (
        <a
          href={link.href}
          class="text-text-body text-sm font-medium tracking-tight transition-colors duration-300 hover:text-white"
        >
          {link.label}
        </a>
      ))}
    </div>

    <!-- CTA Button -->
    <a
      href={APPS.cake.appStoreUrl}
      target="_blank"
      rel="noopener noreferrer"
      class="bg-brand text-white px-5 py-2.5 rounded-full text-sm font-semibold tracking-tight transition-all duration-300 hover:brightness-110 hover:shadow-brand"
    >
      Download
    </a>
  </div>
</nav>

<script>
  function initNavbar() {
    const nav = document.querySelector('.cake-nav');
    if (!nav) return;

    let lastScroll = 0;

    function onScroll() {
      const scrollY = window.scrollY;
      if (scrollY > 50) {
        nav.classList.add('nav-scrolled-cake');
      } else {
        nav.classList.remove('nav-scrolled-cake');
      }
      lastScroll = scrollY;
    }

    window.addEventListener('scroll', onScroll, { passive: true });
    onScroll();
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initNavbar);
  } else {
    initNavbar();
  }
</script>

<style>
  .cake-nav {
    backdrop-filter: blur(0px);
    -webkit-backdrop-filter: blur(0px);
  }

  .cake-nav.nav-scrolled-cake {
    background: rgba(11, 11, 11, 0.8);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }
</style>
